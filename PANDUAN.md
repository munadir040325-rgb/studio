# Panduan Penggunaan Aplikasi Kalender Kegiatan

Dokumen ini berisi panduan lengkap untuk menggunakan fitur-fitur utama dalam aplikasi Kalender Kegiatan.

## Daftar Isi
1. [Menambah Kegiatan Baru](#1-menambah-kegiatan-baru)
2. [Mengedit Kegiatan](#2-mengedit-kegiatan)
3. [Menghapus Kegiatan](#3-menghapus-kegiatan)
4. [Mengunggah Lampiran](#4-mengunggah-lampiran)
5. [Pencarian dan Navigasi Kalender](#5-pencarian-dan-navigasi-kalender)
6. [Membuat Laporan/Notulen](#6-membuat-laporan-notulen)
7. [Tanya Jawab (Q&A) - Troubleshooting](#7-tanya-jawab-qa---troubleshooting)

---

### 1. Menambah Kegiatan Baru

Untuk menambahkan kegiatan atau jadwal baru ke dalam kalender dan Google Sheets secara bersamaan.

**Langkah-langkah:**
1.  Klik tombol **<kbd>+ Tambah</kbd>** yang berada di pojok kanan atas halaman kalender.
2.  Sebuah form modal dengan judul "Tambah Kegiatan Baru" akan muncul.
3.  Isi semua kolom yang wajib diisi:
    *   **Judul Kegiatan (Wajib)**: Nama atau topik utama dari kegiatan.
    *   **Bagian (Wajib)**: Pilih bagian atau seksi yang bertanggung jawab atau melaksanakan kegiatan.
    *   **Waktu Mulai & Selesai (Wajib)**: Tentukan tanggal dan jam mulai hingga selesai kegiatan. Untuk kegiatan yang berlangsung beberapa hari, cukup atur tanggal selesai sesuai durasi.
4.  Isi kolom opsional jika diperlukan:
    *   **Lokasi**: Tempat kegiatan akan dilaksanakan.
    *   **Deskripsi / Disposisi**: Informasi tambahan, instruksi, atau catatan penting (misal: "Dihadiri oleh Camat"). Teks ini juga akan muncul sebagai "Disposisi" di Google Calendar.
5.  Setelah semua data terisi, klik tombol **<kbd>Simpan Kegiatan</kbd>**.
6.  Kegiatan akan otomatis ditambahkan ke Google Calendar dan Google Sheets pada rentang tanggal yang sesuai.

---

### 2. Mengedit Kegiatan

Untuk mengubah detail kegiatan yang sudah ada.

**Langkah-langkah:**
1.  Cari kartu kegiatan yang ingin Anda edit di tampilan kalender.
2.  Pada kartu kegiatan tersebut, klik ikon pensil (**<kbd>PenSquare</kbd>**).
3.  Form modal "Edit Kegiatan" akan muncul dengan semua data yang sudah ada terisi secara otomatis.
4.  Ubah data yang diperlukan (misalnya, judul, waktu, lokasi, atau bagian).
5.  Setelah selesai, klik tombol **<kbd>Simpan Perubahan</kbd>**.
6.  Perubahan akan tersimpan di Google Calendar dan entri yang sesuai di Google Sheets akan diperbarui.

---

### 3. Menghapus Kegiatan

Untuk menghapus kegiatan secara permanen dari kalender dan Google Sheets.

**Langkah-langkah:**
1.  Buka form "Edit Kegiatan" dengan cara yang sama seperti di atas (klik ikon pensil).
2.  Di dalam form, klik tombol merah **<kbd>Hapus Kegiatan</kbd>** yang berada di pojok kiri bawah.
3.  Sebuah dialog konfirmasi akan muncul untuk memastikan Anda benar-benar ingin menghapus.
4.  Klik tombol **<kbd>Ya, Hapus</kbd>**.
5.  Kegiatan akan dihapus dari Google Calendar, dan semua entri terkait di Google Sheets (termasuk untuk kegiatan multi-hari) akan ikut terhapus. **Tindakan ini tidak dapat dibatalkan.**

---

### 4. Mengunggah Lampiran

Untuk melampirkan file hasil kegiatan (undangan, foto, notulen, dll.) langsung ke acara di Google Calendar.

**Langkah-langkah:**
1.  Cari kartu kegiatan yang ingin Anda tambahkan lampirannya.
2.  Pada kartu kegiatan, klik ikon upload (**<kbd>FileUp</kbd>**).
3.  Sebuah form modal "Upload Lampiran" akan muncul.
4.  **Pilih Bagian** yang sesuai (biasanya sudah terisi otomatis).
5.  Gunakan tombol **<kbd>Pilih file...</kbd>** untuk setiap kategori file yang ingin Anda unggah:
    *   **Upload Undangan/Surat Tugas**: Untuk file PDF/DOCX.
    *   **Upload Foto Kegiatan**: Untuk file gambar.
    *   **Upload Notulen/Laporan**: Hanya untuk satu file laporan utama.
    *   **Upload Materi**: Untuk file pendukung lainnya.
6.  Saat pertama kali mengunggah, browser akan meminta izin akses ke Google Drive Anda. **Izinkan** permintaan tersebut.
7.  Setelah memilih file, daftar file akan muncul di bawah tombol upload.
8.  Jika sudah, klik tombol **<kbd>Simpan & Upload Lampiran</kbd>**.
9.  Aplikasi akan mengunggah semua file ke folder yang sesuai di Google Drive, lalu secara otomatis melampirkannya ke acara di Google Calendar.

---

### 5. Pencarian dan Navigasi Kalender

Untuk menemukan kegiatan dengan cepat dan berpindah antar periode waktu.

**Pencarian:**
*   Gunakan kotak **<kbd>Cari kegiatan, lokasi...</kbd>** di bagian atas.
*   Ketik kata kunci yang relevan (nama kegiatan, nama lokasi, disposisi, atau nama bagian).
*   Hasil pencarian akan langsung ditampilkan di area konten.

**Navigasi Waktu:**
*   Gunakan tombol panah **<kbd><</kbd>** dan **<kbd>></kbd>** di samping label tanggal untuk berpindah ke hari, minggu, atau bulan sebelumnya/berikutnya.
*   Klik **ikon kalender** untuk memilih tanggal spesifik dari kalender popup.
*   Ganti mode tampilan antara **Harian**, **Mingguan**, dan **Bulanan** menggunakan tombol tabs untuk melihat jadwal dalam format yang berbeda.

**Mengirim Jadwal Harian via WhatsApp:**
1.  Pastikan Anda berada di tampilan **Harian**.
2.  Klik tombol hijau **<kbd>Kirim Jadwal</kbd>**.
3.  Sebuah modal akan muncul berisi format teks jadwal untuk hari itu.
4.  Klik **<kbd>Salin Teks</kbd>** dan tempelkan di grup WhatsApp Anda.

---

### 6. Membuat Laporan/Notulen

Untuk membuat draf laporan/nota dinas dari sebuah kegiatan yang sudah ada dalam format siap cetak.

**Langkah-langkah:**
1.  Buka halaman **"Buat Laporan"** dari menu sidebar.
2.  **Pilih Tanggal Kegiatan**: Gunakan kalender popup untuk memilih tanggal di mana kegiatan yang ingin Anda laporkan berlangsung.
3.  **Pilih Kegiatan**: Setelah memilih tanggal, daftar kegiatan pada hari itu akan muncul. Pilih kegiatan yang relevan dari dropdown.
4.  Setelah memilih kegiatan, sebuah template laporan akan muncul di bawahnya, dengan data seperti judul, tanggal, dan waktu sudah terisi otomatis.
5.  Isi bagian-bagian yang dapat diedit di dalam template (ditandai dengan area input atau latar belakang abu-abu), seperti:
    *   Kepada Yth, Tembusan, Dari, Hal.
    *   Dasar Kegiatan.
    *   Pimpinan Rapat, Narasumber, Peserta.
    *   Gunakan editor teks untuk mengisi bagian **Hasil dan Tindak Lanjut**.
    *   Isi tempat, tanggal laporan, dan nama pelapor di bagian tanda tangan.
6.  Setelah draf selesai, klik tombol **<kbd>Cetak Laporan</kbd>** di pojok kanan atas untuk membuka pratinjau cetak dan mencetak dokumen.

---

### 7. Tanya Jawab (Q&A) - Troubleshooting

Bagian ini berisi jawaban untuk masalah umum yang mungkin Anda temui saat menggunakan aplikasi.

**T: Muncul pesan error "Quota exceeded" atau aplikasi terasa lambat saat memuat banyak kegiatan.**
**J:** Ini terjadi karena terlalu banyak permintaan data ke Google dalam waktu singkat.
*   **Penyebab**: Versi awal aplikasi meminta data "bagian" untuk setiap kegiatan secara satu per satu. Jika ada 50 kegiatan, terjadi 50 permintaan.
*   **Solusi**: Aplikasi telah dioptimalkan. Sekarang, ia hanya membuat **satu permintaan** untuk mengambil semua informasi "bagian" yang diperlukan untuk semua kegiatan yang ditampilkan, sehingga jauh lebih efisien dan tidak akan melebihi kuota.

**T: Muncul error "Kredensial Google Service Account... belum dikonfigurasi" atau "Kalender/Sheet tidak ditemukan".**
**J:** Error ini berarti aplikasi tidak dapat terhubung ke akun Google Anda.
*   **Penyebab**: File konfigurasi `.env` di server belum diisi dengan benar. Variabel seperti `NEXT_PUBLIC_CALENDAR_ID`, `NEXT_PUBLIC_SHEET_ID`, `GOOGLE_CLIENT_EMAIL`, atau `GOOGLE_PRIVATE_KEY` mungkin kosong atau salah.
*   **Solusi**: Hubungi administrator teknis. Pastikan semua ID dan kredensial Service Account di file `.env` sudah benar dan Service Account tersebut telah diberi akses **Editor** ke Google Calendar, Google Sheet, dan folder Google Drive yang digunakan.

**T: Saat upload lampiran, muncul pesan "Izin Gagal" atau "Gagal mendapatkan izin Google Drive".**
**J:** Ini adalah masalah izin di sisi browser Anda (client-side authorization).
*   **Penyebab**: Browser Anda memblokir pop-up otorisasi Google, atau Anda menolak permintaan izin akses ke Google Drive.
*   **Solusi**:
    1.  Pastikan browser Anda tidak memblokir pop-up dari situs ini.
    2.  Saat jendela otorisasi Google muncul, pastikan Anda **mengizinkan (Allow)** aplikasi untuk mengakses Google Drive Anda.
    3.  Jika masalah berlanjut, coba bersihkan cache browser atau gunakan browser lain.

**T: Saya menambahkan kegiatan multi-hari (misal: 3 hari), tapi di Google Sheet hanya muncul di hari pertama.**
**J:** Masalah ini terjadi pada versi lama dari logika penulisan data.
*   **Penyebab**: Alur kerja lama hanya membaca tanggal mulai kegiatan dan tidak melakukan iterasi untuk setiap hari selama durasi kegiatan.
*   **Solusi**: Sistem telah diperbarui. Sekarang, saat Anda menyimpan kegiatan multi-hari, aplikasi akan secara otomatis mengulang dan menuliskan entri untuk **setiap tanggal** dalam rentang tersebut di Google Sheets, memastikan data selalu sinkron dengan kalender.

**T: Saya mencoba menambahkan kegiatan untuk bulan depan, tapi gagal atau data tidak muncul di Google Sheet.**
**J:** Kemungkinan besar sheet untuk bulan tersebut belum ada.
*   **Penyebab**: Aplikasi menulis ke sheet yang namanya spesifik per bulan (misal: `Giat_Agustus_24`). Jika sheet ini belum dibuat di file Google Sheets Anda, aplikasi tidak akan menemukan tempat untuk menulis.
*   **Solusi**: Buka file Google Sheets utama. Duplikasi salah satu sheet bulan yang sudah ada dan ganti namanya sesuai format `Giat_[NamaBulan]_[TahunSingkat]`. Contoh: `Giat_Desember_24`. Setelah sheet dibuat, aplikasi akan dapat menulis data dengan normal.
